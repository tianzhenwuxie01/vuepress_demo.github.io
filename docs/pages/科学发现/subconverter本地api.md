---
title: subconverteræœ¬åœ°ymlå‚æ•°ç®€ä»‹
date: 2020-04-3 17:25:00
author: 0514
#img: https://one.0514.ink/view/2019/12/21/NMr02MyX/57d172326e39dfbf60fcdb795a08e758.jpg
top: true #(ç½®é¡¶)
#cover: true    #ï¼ˆè½®æ’­ï¼‰
#coverImg: https://one.0514.ink/view/2019/12/21/WEQNERiF/IMG_20180705_173106.jpg
#summary: å¥ˆé£å®¢æˆ·ç«¯--å®‰å“
categories: ç§‘å­¦å‘ç°
tags:
  - ç§‘å­¦ä¸Šç½‘
  - subconverter
  - clash
---

## subconverter ç®€ä»‹

> åœ¨å„ç§è®¢é˜…æ ¼å¼ä¹‹é—´è¿›è¡Œè½¬æ¢çš„å®ç”¨ç¨‹åº.

### æ”¯æŒç±»å‹

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

| ç±»å‹                         | ä½œä¸ºæºç±»å‹ | ä½œä¸ºç›®æ ‡ç±»å‹ | å‚æ•°                |
| ---------------------------- | :--------: | :----------: | ------------------- |
| Clash                        |     âœ“      |      âœ“       | clash               |
| ClashR                       |     âœ“      |      âœ“       | clashr              |
| Quantumult (å®Œæ•´é…ç½®)        |     âœ“      |      âœ“       | quan                |
| Quantumult X (å®Œæ•´é…ç½®)      |     âœ“      |      âœ“       | quanx               |
| Loon                         |     âœ“      |      âœ“       | loon                |
| Mellow                       |     âœ“      |      âœ“       | mellow              |
| SS (SIP002)                  |     âœ“      |      âœ“       | ss                  |
| SS (è½¯ä»¶è®¢é˜…)                |     âœ“      |      âœ“       | sssub               |
| SSD                          |     âœ“      |      âœ“       | ssd                 |
| SSR                          |     âœ“      |      âœ“       | ssr                 |
| Surfboard                    |     âœ“      |      âœ“       | surfboard           |
| Surge 2                      |     âœ“      |      âœ“       | surge&ver=2         |
| Surge 3                      |     âœ“      |      âœ“       | surge&ver=3         |
| Surge 4                      |     âœ“      |      âœ“       | surge&ver=4         |
| Trojan                       |     âœ“      |      âœ“       | trojan              |
| V2Ray                        |     âœ“      |      âœ“       | v2ray               |
| ç±» TG ä»£ç†çš„ HTTP/Socks é“¾æ¥ |     âœ“      |      Ã—       | ä»…æ”¯æŒ `&url=` è°ƒç”¨ |

</details>

1. Shadowrocket ç”¨æˆ·å¯ä»¥ä½¿ç”¨ `ss`ã€`ssr` ä»¥åŠ `v2ray` å‚æ•°

2. ç±» TG ä»£ç†çš„ HTTP/Socks é“¾æ¥ç”±äºæ²¡æœ‰å‘½åè®¾å®šï¼Œæ‰€ä»¥å¯ä»¥åœ¨åæ–¹æ’å…¥`&remarks=`è¿›è¡Œå‘½åï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æ’å…¥ `&group=` è®¾ç½®ç»„åˆ«åç§°ï¼Œä»¥ä¸Šä¸¤ä¸ªå‚æ•°éœ€è¦ç»è¿‡ [URLEncode](https://www.urlencoder.org/) å¤„ç†ï¼Œä¾‹å¦‚

   - tg://http?server=1.2.3.4&port=233&user=user&pass=pass&remarks=Example&group=xxx

   - https://t.me/http?server=1.2.3.4&port=233&user=user&pass=pass&remarks=Example&group=xxx

## subconverter--url é“¾æ¥

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

é»˜è®¤ç”Ÿæˆ url

``` yaml
http://127.0.0.1:25500/sub?target=clash
#target=åé¢æ¥ç”Ÿæˆé…ç½®ç±»å‹ï¼Œå…·ä½“å‚è€ƒä¸Šé¢
```

ä¸Šä¼  gist å¹¶å‘½å

``` yaml
http://127.0.0.1:25500/sub?target=clash&upload=true&upload_path=buding.yml
#upload=trueä¸Šä¼ gistï¼Œupload_path=buding.ymlä¸Šä¼ åç§°ã€‚å¤šä¸ªå‚æ•°&è¿æ¥
```

å¤–éƒ¨å¼•ç”¨é…ç½®æ–‡ä»¶

``` yaml
http://127.0.0.1:25500/getprofile?name=profiles/ces.ini&token=password
#name=åé¢æ¥å¤–éƒ¨é…ç½®æ–‡ä»¶åœ°å€ï¼Œtoken=æ¥common:é‡Œé¢å‚æ•°
```

å¤–éƒ¨å¼•ç”¨çŸ­é“¾æ¥`aliases`å­—æ®µ

``` yaml
http://127.0.0.1:25500/bd
#name=åé¢æ¥å¤–éƒ¨é…ç½®æ–‡ä»¶åœ°å€ï¼Œtoken=æ¥common:é‡Œé¢å‚æ•°
```

è‡ªå®šä¹‰é…ç½®æ¨¡æ¿å‚æ•°

``` yaml
å…·ä½“è§æ¨¡æ¿æ–‡ä»¶è¯´æ˜
global: å®šä¹‰åœ¨prefé‡Œçš„å‚æ•°
local: å®šä¹‰åœ¨å¤–éƒ¨é…ç½®æ–‡ä»¶é‡Œçš„å‚æ•°
request: è¯·æ±‚urlçš„å‚æ•°
#requestæœ‰æŒ‡å®šå°±æ˜¯requestçš„å€¼,æ²¡æœ‰å°±æ˜¯å…¨å±€çš„å€¼
```

</details>

## subconverter--yml å‚æ•°

### common:

> å…¨å±€èŠ‚ç‚¹æ’é™¤æˆ–ä¿ç•™åŠåŸºç¡€é…ç½®

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
common:
  api_mode: false
  #è®¾ç½®ä¸ºtrueæ—¶ ä½¿ç”¨default_urléœ€è¦åœ¨è®¿é—®æ—¶æä¾›api_access_tokenå³åœ¨è¯·æ±‚åœ°å€åæ·»åŠ å‚æ•°token=password

  api_access_token: password

  default_url: ["https://sub88.xyz", "https://"]
  #æ”¯æŒæœ¬åœ°æ–‡ä»¶ / URL
  #å¤šä¸ªè®¢é˜…ymlå†™æ³•]["http...", "http..."]---iniå†™æ³•http... | http...
  #;â“‚ï¸â“‚ï¸â“‚ï¸http
  #;https://t.me/https?server=a4.ap.fastqvpn.com&port=29980&user=282607728952606720&pass=01553893-ec29-49fc-8892-0c81c06c3618&remark=Example

  insert_url: []
  #æ”¯æŒæœ¬åœ°æ–‡ä»¶/ URL
  #æ— è®ºæµè§ˆå™¨urlé“¾æ¥æ˜¯å¦å…·æœ‰ %URL% å‚æ•°æ—¶ï¼Œéƒ½ä¼šåœ¨æ·»åŠ è®¢é˜…å‰åŠ å…¥çš„èŠ‚ç‚¹ï¼Œ ä¸éœ€è¦ URLEncode
  #å¦‚æœæœ‰å¤šä¸ªèŠ‚ç‚¹ï¼Œiniä»ç„¶éœ€è¦ä½¿ç”¨ "|" åˆ†éš”
  #insert_url=ss://Y2hhY2hhMjAtaWV0Zi...
  #insert_url=ss://Y2hhY2hhMjAtaWV0Zi...

  prepend_insert_url: true
  #å°†æ’å…¥çš„URLé™„åŠ åˆ°è®¢é˜…é“¾æ¥ã€‚ insert_urlä¸­çš„èŠ‚ç‚¹å°†é¦–å…ˆä½¿ç”¨éç‰¹å®šäºç»„çš„åŒ¹é…æ¨¡å¼æ·»åŠ åˆ°ç»„ä¸­ã€‚

  exclude_remarks: ["(åˆ°æœŸ|å‰©ä½™æµé‡|æ—¶é—´|å®˜ç½‘|å›å›½|äº§å“)"]
  #æ’é™¤åŒ¹é…åˆ°çš„èŠ‚ç‚¹ï¼Œæ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ã€‚

  include_remarks: []
  #ä»…ä¿ç•™åŒ¹é…åˆ°çš„èŠ‚ç‚¹ã€æ”¯æŒæ­£åˆ™

  enable_filter: false
  #å¯ç”¨è„šæœ¬æ”¯æŒä»¥è¿‡æ»¤èŠ‚ç‚¹

  filter_script: ""
  #å¯ç”¨è„šæœ¬æ”¯æŒä»¥è¿‡æ»¤èŠ‚ç‚¹,æˆ‘æ”¾å¼ƒäº†

  default_external_config: ""
  #å¦‚æœæœªæŒ‡å®šå¤–éƒ¨é…ç½®æ–‡ä»¶ï¼Œåˆ™å°†å…¶è®¾ç½®ä¸ºé»˜è®¤å€¼ã€‚æ”¯æŒ `æœ¬åœ°æ–‡ä»¶` å’Œ `åœ¨çº¿URL`
  #ä¾‹default_external_config: config/example_external_config.ini

  clash_rule_base: base/all_base.tpl #ä»…ä¿ç•™åŒ¹é…åˆ°çš„èŠ‚ç‚¹
  surge_rule_base: base/all_base.tpl
  surfboard_rule_base: base/all_base.tpl
  mellow_rule_base: base/all_base.tpl
  quan_rule_base: base/all_base.tpl
  quanx_rule_base: base/all_base.tpl
  loon_rule_base: base/all_base.tpl
  sssub_rule_base: base/all_base.tpl
  #ç”Ÿæˆçš„å„ç§é…ç½®æ–‡ä»¶åŸºç¡€æ¨¡æ¿ï¼ˆ0.4.3ä»¥å‰ç‰ˆæœ¬ï¼‰
  #æ”¯æŒæœ¬åœ°æˆ–è€…åœ¨çº¿urlï¼Œä¾‹å¦‚ä»¥ç¥æœºä½æ¨¡æ¿
  #clash_rule_base=https://raw.githubusercontent.com/ConnersHua/Profiles/master/Clash/Pro.yaml

  proxy_config: SYSTEM
  #æ›´æ–° å¤–éƒ¨é…ç½®æ–‡ä»¶ æ—¶æ˜¯å¦ä½¿ç”¨ä»£ç†
  #æ”¯æŒhttpå’Œsock5
  #proxy_ruleset: socks5://127.0.0.1:1080 ä½¿ç”¨æœ¬åœ°çš„ 1080 ç«¯å£è¿›è¡Œ SOCKS5 ä»£ç†

  proxy_ruleset: SYSTEM
  #æ›´æ–° RuleSet æ—¶æ˜¯å¦ä½¿ç”¨ä»£ç†å¡«å†™ NONE æˆ–è€…ç©ºç™½ç¦ç”¨ï¼Œæˆ–è€…å¡«å†™ SYSTEM ä½¿ç”¨ç³»ç»Ÿä»£ç†
  #åŒä¸Š

  proxy_subscription: NONE
  #æ›´æ–° åŸå§‹è®¢é˜… æ—¶æ˜¯å¦ä½¿ç”¨ä»£ç†
  #åŒä¸Š

  append_proxy_type: false
  #è®¾ç½®ä¸º true æ—¶åœ¨èŠ‚ç‚¹åç§°å‰åŠ å…¥ [SS] [SSR] [VMess] ä»¥ä½œåŒºåˆ«
```

</details>

### userinfo:

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
userinfo:
  stream_rule:
    - { match: "^å‰©ä½™æµé‡ï¼š(.*?)\\|æ€»æµé‡ï¼š(.*)$", replace: "total=$2&left=$1" }
    - { match: "^å‰©ä½™æµé‡ï¼š(.*?) (.*)$", replace: "total=$1&left=$2" }
    - { match: "^Bandwidth: (.*?)/(.*)$", replace: "used=$1&total=$2" }
    - { match: "^.*å‰©ä½™(.*?)(?:\\s*?)@(?:.*)$", replace: "total=$1" }
    - { match: "^.*?æµé‡:(.*?) å‰©:(?:.*)$", replace: "total=$1" }
  #ä»èŠ‚ç‚¹æå–æµæ•°æ®çš„è§„åˆ™
  time_rule:
    - {
        match: "^è¿‡æœŸæ—¶é—´ï¼š(\\d+)-(\\d+)-(\\d+) (\\d+):(\\d+):(\\d+)$",
        replace: "$1:$2:$3:$4:$5:$6",
      }
    - {
        match: "^åˆ°æœŸæ—¶é—´(:|ï¼š)(\\d+)-(\\d+)-(\\d+)$",
        replace: "$1:$2:$3:0:0:0",
      }
    - {
        match: "^Smart Access expire: (\\d+)/(\\d+)/(\\d+)$",
        replace: "$1:$2:$3:0:0:0",
      }
    - { match: "^.*?æµé‡:(?:.*?) å‰©:(.*?)å¤©$", replace: "left=$1d" }
  #ä»èŠ‚ç‚¹æå–è¿‡æœŸæ—¶é—´æ•°æ®çš„è§„åˆ™
```

</details>

### node_pref:

> è¯¥éƒ¨åˆ†ä¸»è¦æ¶‰åŠåˆ°çš„å†…å®¹ä¸º **å¼€å¯èŠ‚ç‚¹çš„ UDP åŠ TCP Fast Open** ã€**èŠ‚ç‚¹çš„é‡å‘½å** ã€**é‡å‘½åèŠ‚ç‚¹åçš„æ’åº**

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
node_pref:
  udp_flag: false
  #ä¸ºèŠ‚ç‚¹æ‰“å¼€ UDP æ¨¡å¼ï¼Œè®¾ç½®ä¸º true æ—¶æ‰“å¼€ï¼Œé»˜è®¤ä¸º false
  #å½“ä¸æ¸…æ¥šæœºåœºçš„è®¾ç½®æ—¶è¯·å‹¿è°ƒæ•´æ­¤é¡¹ã€‚

  tcp_fast_open_flag: false
  #ä¸ºèŠ‚ç‚¹æ‰“å¼€ TFO (TCP Fast Open) æ¨¡å¼ï¼Œè®¾ç½®ä¸º true æ—¶æ‰“å¼€ï¼Œé»˜è®¤ä¸º false
  #å½“ä¸æ¸…æ¥šæœºåœºçš„è®¾ç½®æ—¶è¯·å‹¿è°ƒæ•´æ­¤é¡¹ã€‚

  sort_flag: true
  #å¯¹ç”Ÿæˆçš„è®¢é˜…ä¸­çš„èŠ‚ç‚¹è¿›è¡Œ A-Z çš„æ’åºï¼Œè®¾ç½®ä¸º true æ—¶æ‰“å¼€ï¼Œé»˜è®¤ä¸º false

  skip_cert_verify_flag: false
  #å…³é—­ TLS èŠ‚ç‚¹çš„è¯ä¹¦æ£€æŸ¥ï¼Œè®¾ç½®ä¸º true æ—¶æ‰“å¼€ï¼Œé»˜è®¤ä¸º false
  #è¯·å‹¿éšæ„å°†æ­¤è®¾ç½®ä¿®æ”¹ä¸º true

  filter_deprecated_nodes: false
  #æ’é™¤å½“å‰ target= ä¸æ”¯æŒçš„èŠ‚ç‚¹ç±»å‹é»˜è®¤false å¯ä»¥æ‰“å¼€

  append_sub_userinfo: true

  clash_use_new_field_name: false
  #clashå†…æ ¸0.19.0æ–°åˆ†ç»„å‚æ•°

  rename_node:
    #  - {match: "\\(?((x|X)?(\\d+)(\\.?\\d+)?)((\\s?å€ç‡?)|(x|X))\\)?", replace: "$1x"}
    #  - {script: "function rename(node){}"}
    #  - {script: "path:/path/to/script.js"}
    - { import: snippets/rename_node.txt }
  #é‡å‘½åèŠ‚ç‚¹ï¼Œæ”¯æŒæ­£åˆ™åŒ¹é….ä½¿ç”¨æ–¹å¼ï¼šåŸå§‹å‘½å@é‡å‘½å
  #ç”¨æ³•å¦‚ä¸Šï¼Œæ”¯æŒå•æ¡æ­£åˆ™æˆ–æ–‡æœ¬è½½å…¥
  #ç‰¹æ®Šç”¨æ³•:â“‚ï¸â“‚ï¸â“‚ï¸
  #rename_node=!!GROUPID=0!!ä¸­å›½@ä¸­ï¼Œrename_node: "!!GROUPID=0!!ä¸­å›½@ä¸­"
  #æŒ‡å®šæ­¤é‡å‘½åä»…åœ¨ç¬¬ä¸€ä¸ªè®¢é˜…çš„èŠ‚ç‚¹ä¸­ç”Ÿæ•ˆ
```

</details>

### managed_config:

> è¯¥éƒ¨åˆ†ä¸»è¦æ¶‰åŠåˆ°çš„å†…å®¹ä¸º **è®¢é˜…æ–‡ä»¶çš„æ›´æ–°åœ°å€**
> å¤šåŠæ˜¯ surgeï¼Œsurfboardï¼Œquanx

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
managed_config:
  write_managed_config: true
  #æ˜¯å¦å°† '#!MANAGED-CONFIG' ä¿¡æ¯é™„åŠ åˆ° Surge æˆ– Surfboard é…ç½®ï¼Œè®¾ç½®ä¸º true æ—¶æ‰“å¼€ï¼Œé»˜è®¤ä¸º true
  managed_config_prefix:
    "http://127.0.0.1:25500"
    # å…·ä½“çš„ '#!MANAGED-CONFIG' ä¿¡æ¯ï¼Œåœ°å€å‰ç¼€ä¸ç”¨æ·»åŠ  "/"ã€‚
    # Surge æˆ– Surfboard ä¼šå‘æ­¤åœ°å€å‘å‡ºæ›´æ–°è¯·æ±‚ï¼ŒåŒæ—¶æœ¬åœ° ruleset è½¬ url ä¼šç”¨æ­¤ç”Ÿæˆ/getruleseté“¾æ¥ã€‚
    # å±€åŸŸç½‘ç”¨æˆ·éœ€è¦å°†æ­¤å¤„æ”¹ä¸ºæœ¬ç¨‹åºè¿è¡Œè®¾å¤‡çš„å±€åŸŸç½‘ IP,ä¾‹å¦‚managed_config_prefix = http://192.168.1.5:25500
  config_update_interval: 86400
  #æ‰˜ç®¡é…ç½®æ›´æ–°é—´éš”ï¼Œç¡®å®šé…ç½®å°†æ›´æ–°å¤šé•¿æ—¶é—´ï¼Œå•ä½ä¸ºç§’
  config_update_strict: false
  #å¦‚æœ config_update_struct ä¸º trueï¼Œåˆ™ Surge å°†åœ¨ä¸Šè¿°é—´éš”åè¦æ±‚å¼ºåˆ¶æ›´æ–°ã€‚
  quanx_device_id: ""
  #ç”¨äºé‡å†™ Quantumult X è¿œç¨‹ JS ä¸­çš„è®¾å¤‡ IDï¼Œè¯¥ ID åœ¨ Quantumult X è®¾ç½®ä¸­è‡ªè¡ŒæŸ¥æ‰¾
```

</details>

### surge_external_proxy:

> ä¸º Surge æ·»åŠ  SSR çš„æ”¯æŒè·¯å¾„

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
surge_external_proxy: #ä¸º Surge æ·»åŠ  SSR çš„æ”¯æŒè·¯å¾„
  surge_ssr_path: "" # /usr/bin/ssr-local
```

</details>

### emojis:

> è¡¨æƒ…éƒ¨åˆ†

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
emojis:
  add_emoji: true
  #æ˜¯å¦åœ¨èŠ‚ç‚¹åç§°å‰åŠ å…¥ä¸‹é¢è‡ªå®šä¹‰çš„ Emoji
  remove_old_emoji:
  true
  #æ˜¯å¦ç§»é™¤åŸæœ‰è®¢é˜…ä¸­å­˜åœ¨çš„ Emojiï¼Œè®¾ç½®ä¸º true æ—¶æ‰“å¼€ï¼Œé»˜è®¤ä¸º true
  rules:
  #åœ¨åŒ¹é…åˆ°çš„èŠ‚ç‚¹å‰æ·»åŠ è‡ªå®šä¹‰ emojisï¼Œæ”¯æŒæ­£åˆ™åŒ¹é…
  - {match: "(æµé‡|æ—¶é—´|åº”æ€¥)", emoji: "ğŸ³ï¸â€ğŸŒˆ"}
  - {import: snippets/emoji.txt}
  - match: "!!GROUPID=0!!(æµé‡|æ—¶é—´|åº”æ€¥)", emoji: "ğŸ³ï¸â€ğŸŒˆ"
  #ç‰¹æ®Šç”¨æ³•
  #iniè¯­æ³•rule=!!GROUPID=0!!(æµé‡|æ—¶é—´|åº”æ€¥),âŒ›time
  #æŒ‡å®šæ­¤ Emoji è§„åˆ™ä»…åœ¨ç¬¬ä¸€ä¸ªè®¢é˜…çš„èŠ‚ç‚¹ä¸­ç”Ÿæ•ˆ

```

</details>

### ruleset:

> è§„åˆ™éƒ¨åˆ†

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
ruleset:
  enabled: true
  #å¯ç”¨è‡ªå®šä¹‰è§„åˆ™é›†çš„æ€»å¼€å…³
  overwrite_original_rules: false
  #è¦†ç›–åŸæœ‰è§„åˆ™ï¼Œå³ [common] ä¸­ xxx_rule_base ä¸­çš„å†…å®¹
  update_ruleset_on_request: false
  #æ ¹æ®è¯·æ±‚æ‰§è¡Œè§„åˆ™é›†æ›´æ–°
  rulesets:
    #ä»æœ¬åœ°æˆ–urlè·å–è§„åˆ™
    #  - {rule: "GEOIP,CN", group: "DIRECT"}
    #  - {ruleset: "rules/LocalAreaNetwork.list", group: "DIRECT"}
    #  - {ruleset: "surge:rules/LocalAreaNetwork.list", group: "DIRECT"}
    #  - {ruleset: "quanx:https://raw.githubusercontent.com/ConnersHua/Profiles/master/Quantumult/X/Filter/Advertising.list", group: "Advertising"}
    #  - {ruleset: "clash-domain:https://ruleset.dev/clash_domestic_services_domains", group: "Domestic Services"}
    #  - {ruleset: "clash-ipcidr:https://ruleset.dev/clash_domestic_services_ips", group: "Domestic Services"}
    #  - {ruleset: "clash-classic:https://raw.githubusercontent.com/DivineEngine/Profiles/master/Clash/RuleSet/China.yaml", group: "DIRECT"}
    - { import: snippets/rulesets-chaoxi.txt } #æ½®æ±
  #æ”¯æŒåœ¨çº¿é“¾æ¥
```

</details>

### proxy_group:

> ä¸º Clash ã€Mellow ã€Surge ä»¥åŠ Surfboard ç­‰ç¨‹åºåˆ›å»ºç­–ç•¥ç»„

<details>
<summary><b style="color:#B47CFD">[clash_proxy_group] éƒ¨åˆ†</b></summary>

``` yaml
proxy_group: #ä¸º Clash ã€Mellow ã€Surge ä»¥åŠ Surfboard ç­‰ç¨‹åºåˆ›å»ºç­–ç•¥ç»„
  custom_proxy_group:
    #  - {name: UrlTest, type: url-test, rule: [".*"], url: http://www.gstatic.com/generate_204, interval: 300, tolerance: 100, timeout: 5}
    #  - {name: Proxy, type: select, rule: [".*"]}
    #  - {name: group1, type: select, rule: ["!!GROUPID=0"]}
    #  - {name: v2ray, type: select, rule: ["!!GROUP=V2RayProvider"]}
    #  - {import: snippets/groups_forcerule.txt}
    #  - {name: ssid group, type: ssid, rule: ["default_group", "celluar=group0,ssid1=group1,ssid2=group2"]}
    - { import: snippets/groups-chaoxi.txt } #æ½®æ±
```

> ç‰¹æ®Šè¯­æ³•

``` ini
custom_proxy_group=g1hk`select`!!GROUPID=0!!(HGC|HKBN|PCCW|HKT|hk|æ¸¯)
# è®¢é˜…é“¾æ¥ä¸­çš„ç¬¬ä¸€æ¡è®¢é˜…å†…åå­—å« HGCã€HKBNã€PCCWã€HKTã€hkã€æ¸¯ çš„èŠ‚ç‚¹
```

</details>

### template:

> é…ç½®æ¨¡å—

<details>
<summary><b style="color:#B47CFD">[clash_proxy_group] éƒ¨åˆ†</b></summary>

``` yaml
template:
  template_path: "template"
  globals:
    - { key: clash.http_port, value: 7890 }
    - { key: clash.socks_port, value: 7891 }
    - { key: clash.allow_lan, value: true }
    - { key: clash.log_level, value: info }
  #global å®šä¹‰åœ¨prefé‡Œçš„å‚æ•° local å®šä¹‰åœ¨å¤–éƒ¨é…ç½®æ–‡ä»¶é‡Œçš„å‚æ•° request è¯·æ±‚urlçš„å‚æ•°
  #requestæœ‰æŒ‡å®šå°±æ˜¯requestçš„å€¼æ²¡æœ‰å°±æ˜¯å…¨å±€çš„å€¼
```

</details>

### aliases çŸ­é“¾æ¥

å…·ä½“ url é“¾æ¥è§ä¸Šé¢

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
aliases:
  - { uri: /bd, target: "/getprofile?name=profiles/buding.ini&token=password" }
  - {
      uri: /bd2,
      target: "/getprofile?name=profiles/buding.ini&token=password&expand=false&classic=true",
    }
  - {
      uri: /bd3,
      target: "/getprofile?name=profiles/buding.ini&token=password&script=true&expand=false&classic=true",
    }
  - {
      uri: /ssrcloud,
      target: "/getprofile?name=profiles/ssrcloud.ini&token=password",
    }
  - {
      uri: /ssrcloud2,
      target: "/getprofile?name=profiles/ssrcloud.ini&token=password&expand=false&classic=true",
    }
  - {
      uri: /ssrcloud3,
      target: "/getprofile?name=profiles/ssrcloud.ini&token=password&script=true&expand=false&classic=true",
    }
  - {
      uri: /ssrcloud-gta,
      target: "/getprofile?name=profiles/gta5.ini&token=password&expand=false&classic=true",
    }
  - {
      uri: /chaoxi,
      target: "/getprofile?name=profiles/chaoxi.ini&token=password",
    }
  # - {uri: /v2tun, target: "/getprofile?name=profiles/v2tun.ini&token=password"}
  # - {uri: /bdcfw, target: "/getprofile?name=profiles/buding.ini&token=password&clash.dns=cfw"}
  - {
      uri: /chaoxicfw,
      target: "/getprofile?name=profiles/chaoxi.ini&token=password&clash.dns=cfw",
    }
  # - {uri: /v2tuncfw, target: "/getprofile?name=profiles/v2tun.ini&token=password&clash.dns=cfw"}
  # - {uri: /buding-surf, target: "/getprofile?name=profiles/buding-surf.ini&token=password"}
  # - {uri: /v2tun-surf, target: "/getprofile?name=profiles/v2tun-surf.ini&token=password"}
  - {
      uri: /piao1,
      target: "/getprofile?name=profiles/piao1.ini&token=password",
    }
```

</details>

### generate ç”Ÿæˆåä¸‹è½½åˆ°æœ¬åœ°

åœ¨ç¨‹åºç›®å½•å†…çš„ .ini ä¸­è®¾å®šæ–‡ä»¶å—([xxx])ï¼Œç”Ÿæˆçš„æ–‡ä»¶å(path=xxx)ä»¥åŠå…¶æ‰€éœ€è¦åŒ…å«çš„å‚æ•°ï¼Œä¾‹å¦‚ï¼š

<details>
<summary><b style="color:#B47CFD">ç‚¹å‡»æŸ¥çœ‹æ–‡ä»¶å†…å®¹</b></summary>

``` yaml
[bd]
path=pref/peizhi/bd.yml ;è²Œä¼¼ä¸­æ–‡è·¯å¾„ä¸æ”¯æŒ
profile=profiles/buding.ini

[v2tun]
path=pref/peizhi/v2tun.yml
profile=profiles/v2tun.ini

[chaoxi]
path=pref/peizhi/chaoxi.yml
profile=profiles/chaoxi.ini

[å¸ƒä¸-surf]
path=pref/peizhi/bd-surf.conf
profile=profiles/buding-surf.ini

```

</details>

ä½¿ç”¨ subconverter -g å¯åŠ¨æœ¬ç¨‹åºæ—¶ï¼Œå³å¯åœ¨ç¨‹åºæ ¹ç›®å½•å†…ç”Ÿæˆåä¸º output.conf output.yml çš„é…ç½®æ–‡ä»¶æ–‡æœ¬ã€‚

ä½¿ç”¨ subconverter -g --artifact "test" å¯åŠ¨æœ¬ç¨‹åºæ—¶ï¼Œå³å¯åœ¨ç¨‹åºæ ¹ç›®å½•å†…ä»…ç”Ÿæˆä¸Šè¿°ç¤ºä¾‹ä¸­ [test] æ–‡ä»¶å—æ‰€æŒ‡ä»£çš„ output.conf çš„é…ç½®æ–‡ä»¶æ–‡æœ¬ã€‚

win å…ˆåˆ° sub ç›®å½•æ‰“å¼€å‘½ä»¤è¡Œ,`.\subconverter -g`æ‰§è¡Œå‘½ä»¤

## è§„åˆ™åˆ†ç»„æ–‡ä»¶

### groups

<details>
<summary><b style="color:#B47CFD">[clash_proxy_group] éƒ¨åˆ†</b></summary>

``` ini
ğŸš€ èŠ‚ç‚¹é€‰æ‹©`select`[]âœˆï¸ ä¸€ç»„é¦™æ¸¯`[]ğŸ’© è¾£é¸¡é€šç”¨`[]ğŸ³ ä¸“çº¿`[]ğŸ‘» å°æ—¥æœ¬`[]ğŸ¦… ç¾å›½ä½¬`[]ğŸ”¥ å¤©é€‰ä¹‹å­`[]ğŸ« å…¨çƒç›´è¿`
ğŸ¥ NETFLIX`select`[]ğŸ“¹ å¥ˆé£`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]ğŸ« å…¨çƒç›´è¿`
ğŸ›‘ å¹¿å‘Šæ‹¦æˆª`select`[]â›” å…¨çƒæ‹¦æˆª`[]ğŸ« å…¨çƒç›´è¿`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©
ğŸŒµ åº”ç”¨å¹¿å‘Š`select`[]â›” å…¨çƒæ‹¦æˆª`[]ğŸ« å…¨çƒç›´è¿
ğŸŒ å›½å¤–åª’ä½“`select`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]âœˆï¸ ä¸€ç»„é¦™æ¸¯`[]ğŸ‘» å°æ—¥æœ¬`[]ğŸ¦… ç¾å›½ä½¬`[]ğŸ« å…¨çƒç›´è¿`
ğŸŒ å›½å†…åª’ä½“`select`[]ğŸ« å…¨çƒç›´è¿`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`
;â“‚ï¸ å¾®è½¯æœåŠ¡`select`[]ğŸ« å…¨çƒç›´è¿`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`
ğŸ“² ç”µæŠ¥ä¿¡æ¯`select`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]ğŸ« å…¨çƒç›´è¿`
ğŸ è‹¹æœæœåŠ¡`select`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]ğŸ« å…¨çƒç›´è¿`[]âœˆï¸ ä¸€ç»„é¦™æ¸¯`[]ğŸ‘» å°æ—¥æœ¬`[]ğŸ¦… ç¾å›½ä½¬`
ğŸ“¹ å¥ˆé£`select`!!GROUPID=0!!^.*(nf|NetFLix).*$`
ğŸ³ ä¸“çº¿`select`!!GROUPID=1!!^.*(IPLC).*$`http://www.gstatic.com/generate_204`300
âœˆï¸ ä¸€ç»„é¦™æ¸¯`url-test`!!GROUPID=0!!^(?!.*é€šç”¨).*é¦™æ¸¯.*$`http://www.gstatic.com/generate_204`300
ğŸ’© è¾£é¸¡é€šç”¨`url-test`!!GROUPID=0!!^.*é€šç”¨.*$`http://www.gstatic.com/generate_204`300
ğŸ‘» å°æ—¥æœ¬`url-test`!!GROUPID=0!!^.*æ—¥æœ¬.*$`http://www.gstatic.com/generate_204`300
ğŸ¦… ç¾å›½ä½¬`url-test`!!GROUPID=0!!^.*ç¾å›½.*$`http://www.gstatic.com/generate_204`300
;â˜¢ï¸ é«˜å€`url-test`^.*(10å€)(?!.*å…¬ç½‘).*$`http://www.gstatic.com/generate_204`300
ğŸ”¥ å¤©é€‰ä¹‹å­`select`.*
ğŸ« å…¨çƒç›´è¿`select`[]DIRECT
â›” å…¨çƒæ‹¦æˆª`select`[]REJECT`[]DIRECT
ğŸ³ æ¼ç½‘é±¼å„¿`select`[]ğŸš€ èŠ‚ç‚¹é€‰æ‹©`[]ğŸ« å…¨çƒç›´è¿`
;!!GROUPID=0!!^.*ç¾å›½.*$ï¼šåªåœ¨ç¬¬ä¸€ä¸ªè®¢é˜…ä¸­ä½¿ç”¨æ­£åˆ™
```

</details>

## 0.5.0 ä¹‹åæ¨¡æ¿æ–‡ä»¶

<details>
<summary><b style="color:#B47CFD">æˆ‘çš„æ¨¡æ¿base.tpl</b></summary>

``` yaml
{% if request.target == "clash" or request.target == "clashr" %}

port: {{ global.clash.http_port }}
socks-port: {{ global.clash.socks_port }}
allow-lan: {{ global.clash.allow_lan }}
mode: Rule
log-level: {{ global.clash.log_level }}
external-controller: :9090
{% if request.clash.dns == "cfw" %} #å¦‚æœæœ‰clash.dns=cfwæ—¶ä½¿ç”¨å¦‚ä¸‹é…ç½®
dns:
  enable: true
  enhanced-mode: fake-ip
  listen: 0.0.0.0:53
  fake-ip-filter: # fake ip ç™½åå•åˆ—è¡¨ï¼Œå¦‚æœä½ ä¸çŸ¥é“è¿™ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œè¯·å‹¿ä¿®æ”¹
     - '*.lan'
     - localhost.ptlogin2.qq.com
     - 'dns.msftncsi.com'
     - 'www.msftncsi.com'
     - 'www.msftconnecttest.com'
  nameserver:
     - 223.5.5.5
     - 114.114.114.114
  fallback:
     - 8.8.8.8
     - 1.1.1.1
     - tls://1.0.0.1:853
{% else %} #å¦‚æœæ²¡æœ‰clash.dns=cfwåˆ™ä½¿ç”¨
dns:
  enable: true
  enhanced-mode: fake-ip
  listen: 127.0.0.1:5450 #åŸclashaçš„dnsæ¥å£ï¼Œé…åˆadgä½¿ç”¨
  fake-ip-filter: # fake ip ç™½åå•åˆ—è¡¨ï¼Œå¦‚æœä½ ä¸çŸ¥é“è¿™ä¸ªå‚æ•°çš„ä½œç”¨ï¼Œè¯·å‹¿ä¿®æ”¹
     - '*.lan'
     - localhost.ptlogin2.qq.com
     - 'dns.msftncsi.com'
     - 'www.msftncsi.com'
     - 'www.msftconnecttest.com'
  nameserver:
     - 223.5.5.5
     - 114.114.114.114
  fallback:
     - 8.8.8.8
     - 1.1.1.1
     - tls://1.0.0.1:853
{% endif %}
{% if request.clash.tap == "1" %} #æœ‰clash.tapæ—¶ï¼Œå¯ç”¨wlanå‚æ•°
experimental:
  interface-name: WLAN
{% endif %}
{% if local.clash.new_field_name == "true" %}
proxies: ~
proxy-groups: ~
rules: ~
{% else %}
Proxy: ~
Proxy Group: ~
Rule: ~
{% endif %}

{% endif %}



{% if request.target == "surfboard" %}

[General]
loglevel = notify #æ—¥å¿—çº§åˆ«
interface = 127.0.0.1
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, 100.64.0.0/10, localhost, *.local #ç»•è¿‡ip
ipv6 = false
dns-server = system, 223.5.5.5, 8.8.8.8 #dnsè®¾ç½®
exclude-simple-hostnames = true
enhanced-mode-by-rule = true
{% endif %}

```

</details>

<details>
<summary><b style="color:#B47CFD">æ¨¡æ¿å‚æ•°è°ƒç”¨è¯´æ˜</b></summary>
æ¨¡æ¿å†…çš„å¸¸ç”¨å†™æ³•æœ‰ä»¥ä¸‹å‡ ç±»ï¼š

> å„ç§åˆ¤æ–­å¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œä½†éœ€è¦ç¡®ä¿é€»è¾‘å…³ç³»æ²¡æœ‰é—®é¢˜ï¼Œå³æœ‰ `if` å°±è¦æœ‰ `endif`
>
> æ›´å¤šçš„ä½¿ç”¨æ–¹å¼å¯ä»¥å‚ç…§ [INJA è¯­æ³•](https://github.com/pantor/inja)

1. å–å€¼

   ```inja
   {{ global.clash.http_port }}
   # è·å– é…ç½®æ–‡ä»¶ ä¸­ clash.http_port çš„å€¼
   ```

1. å•åˆ¤æ–­

   ```inja
   {% if request.clash.dns == "1" %}
   Â·Â·Â·
   {% endif %}
   # å¦‚æœ URL ä¸­çš„ clash.dns=1 æ—¶ï¼Œåˆ¤æ–­æˆç«‹
   ```

1. æˆ–åˆ¤æ–­

   ```inja
   {% if request.target == "clash" or request.target == "clashr" %}
   Â·Â·Â·
   {% endif %}
   # å¦‚æœ URL ä¸­çš„ target ä¸º clash æˆ–è€… clashr æ—¶ï¼Œåˆ¤æ–­æˆç«‹
   ```

1. å¦‚æœ...å¦åˆ™...

   ```inja
   {% if local.clash.new_field_name == "true" %}
   proxies: ~
   proxy-groups: ~
   rules: ~
   {% else %}
   Proxy: ~
   Proxy Group: ~
   Rule: ~
   {% endif %}
   # å¦‚æœ å¤–éƒ¨é…ç½®ä¸­ clash.new_field_name=true æ—¶ï¼Œå¯ç”¨ æ–°çš„ Clash å—åç§°ï¼Œå¦åˆ™ä½¿ç”¨æ—§çš„åç§°
   ```

1. å¦‚æœå­˜åœ¨...åˆ™...(å¯é¿å…è¯·æ±‚ä¸­æ— å¯¹åº”å‚æ•°æ—¶å‘ç”Ÿçš„æŠ¥é”™)

   ```inja
   {% if exists("request.clash.dns") %}
   dns:
     enabled: true
     listen: 1053
   {% endif %}
   # å¦‚æœ URL ä¸­å­˜åœ¨å¯¹ clash.dns å‚æ•°çš„ä»»æ„æŒ‡å®šæ—¶ï¼Œåˆ¤æ–­æˆç«‹ (å¯ä»¥å’Œ å¦‚æœÂ·Â·Â·å¦åˆ™Â·Â·Â· ç­‰åˆ¤æ–­ä¸€èµ·ä½¿ç”¨)
   ```

æ¨¡æ¿å†…çš„å¼•ç”¨æœ‰ä»¥ä¸‹å‡ ç±»ï¼š

1. ä» é…ç½®æ–‡ä»¶ ä¸­è·å–ï¼Œåˆ¤æ–­å‰ç¼€ä¸º `global`

   ```inja
   socks-port: {{ global.clash.socks_port }}
   # å½“é…ç½®æ–‡ä»¶ä¸­è®¾å®šäº† `clash.socks_port` å€¼æ—¶ï¼Œå°†è¢«å¼•ç”¨
   ```

1. ä» å¤–éƒ¨é…ç½® ä¸­è·å–ï¼Œåˆ¤æ–­å‰ç¼€ä¸º `local`

   ```inja
   {% if local.clash.new_field_name =="true" %}
   Â·Â·Â·
   {% endif %}
   # å½“å¤–éƒ¨é…ç½®ä¸­è®¾å®šäº† `clash.new_field_name=true` æ—¶ï¼Œè¯¥åˆ¤æ–­ç”Ÿæ•ˆï¼Œå…¶åŒ…å«çš„Â·Â·Â·å†…å®¹è¢«å¼•ç”¨
   ```

1. ä» URL é“¾æ¥ä¸­è·å–ï¼Œåˆ¤æ–­å‰ç¼€ä¸º `request`ï¼Œä¾‹å¦‚ `http://127.0.0.1:25500/sub?target=clash&url=www.xxx.com&clash.dns=1`

   - ä» URL ä¸­æ‰€è·å¾—**åŒ…å«**åœ¨ [è¿›é˜¶é“¾æ¥](#è¿›é˜¶é“¾æ¥) å†…çš„å‚æ•°è¿›è¡Œåˆ¤æ–­

     ```inja
     {% if request.target == "clash" %}
     Â·Â·Â·
     {% endif %}
     # å½“ target=clash æ—¶ï¼Œè¯¥åˆ¤æ–­ç”Ÿæ•ˆï¼Œå…¶åŒ…å«çš„Â·Â·Â· å†…å®¹è¢«å¼•ç”¨
     ```

   - ä» URL ä¸­æ‰€è·å¾—**ä¸åŒ…å«**åœ¨ [è¿›é˜¶é“¾æ¥](#è¿›é˜¶é“¾æ¥) å†…çš„å‚æ•°è¿›è¡Œåˆ¤æ–­ (ä»ä¸Šè¿°é“¾æ¥å¯ä»¥çœ‹å‡º clash.dns å±äºé¢å¤–å‚æ•°)

     ```inja
     {% if request.clash.dns == "1" %}
     dns:
       enabled: true
       listen: 1053
     {% endif %}
     # å½“ clash.dns=1 æ—¶ï¼Œè¯¥åˆ¤æ–­ç”Ÿæ•ˆï¼Œå…¶åŒ…å«çš„ dns å†…å®¹è¢«å¼•ç”¨
     ```

#### ç›´æ¥æ¸²æŸ“

åœ¨å¯¹æ¨¡æ¿åŠŸèƒ½è¿›è¡Œè°ƒè¯•æˆ–éœ€è¦ç›´æ¥å¯¹æ¨¡æ¿è¿›è¡Œæ¸²æŸ“æ—¶ï¼Œæ­¤æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ–¹å¼è¿›è¡Œè°ƒç”¨

``` txt
http://127.0.0.1:25500/render?path=xxx&é¢å¤–çš„è°ƒè¯•æˆ–æ§åˆ¶å‚æ•°
```

æ­¤å¤„ `path` éœ€è¦åœ¨ [é…ç½®æ–‡ä»¶](#é…ç½®æ–‡ä»¶) ä¸­ `template_path` æ‰€é™å®šçš„è·¯å¾„å†…

</details>

## åœ¨çº¿ api æŒ‚ vps

### ä¸Šä¼ å¹¶å¯åŠ¨ sub ç¨‹åº

```
./sub(ç¨‹åºåç§°)
```

### ä¿æŒåå°è¿è¡Œ

```
./sub &
disown
```

> æ­¤æ—¶ sub ç¨‹åºå°±è¢«ç§»å…¥åå°åˆ—è¡¨äº†

### æŸ¥çœ‹è¿›ç¨‹

```
pså‘½ä»¤æŸ¥æ‰¾ä¸è¿›ç¨‹ç›¸å…³çš„PIDå·
ps a æ˜¾ç¤ºç°è¡Œç»ˆç«¯æœºä¸‹çš„æ‰€æœ‰ç¨‹åºï¼ŒåŒ…æ‹¬å…¶ä»–ç”¨æˆ·çš„ç¨‹åºã€‚
ps -A æ˜¾ç¤ºæ‰€æœ‰ç¨‹åº(å¯ä»¥æ‰¾åˆ°subç¨‹åº)

æ€æ­»ç¨‹åºkill xxx
å¼ºåˆ¶æ€æ­»kill -9 xxx
```
